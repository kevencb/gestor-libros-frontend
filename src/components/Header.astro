---

---

<meta charset="UTF-8" />
<link rel="stylesheet" href="/src/styles/global.css" />

<header class="header container">
  <div>
    <a class="logo" href="/"
      >Mi<svg
        xmlns="http://www.w3.org/2000/svg"
        width="36"
        height="36"
        fill="currentColor"
        class="bi bi-book-half"
        viewBox="0 0 16 16"
      >
        <path
          d="M8.5 2.687c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783"
        ></path>
      </svg>Librero
    </a>
  </div>
  <nav class="nav">
    <a href="/recommended" class="nav-link">Recomendados del mes</a>
    <a id="favoritesLink" href="/favorites" style="display:none;">Favoritos</a>
    <a id="adminLink" href="/admin/upload" style="display:none;">Admin</a>
    <a href="/login" id="authLink" class="nav-link">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        fill="currentColor"
        class="bi bi-person-circle"
        viewBox="0 0 16 16"
      >
        <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0"></path>
        <path
          fill-rule="evenodd"
          d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1"
        ></path>
      </svg>
    </a>
    <button id="logoutBtn" class="btn-logout">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        fill="currentColor"
        class="bi bi-box-arrow-right"
        viewBox="0 0 16 16"
      >
        <path
          fill-rule="evenodd"
          d="M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0z"
        ></path>
        <path
          fill-rule="evenodd"
          d="M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708z"
        ></path>
      </svg>
    </button>
  </nav>
</header>

<script>
  if (typeof window !== "undefined") {
    const authLink = document.getElementById("authLink");
    const logoutBtn = document.getElementById("logoutBtn");
    const favoritesLink = document.getElementById("favoritesLink");
    const adminLink = document.getElementById("adminLink");

    function refreshHeader() {
      const data = localStorage.getItem("user");
      const user = data ? JSON.parse(data) : null;

      if (!user || !user.token) {
        if (authLink) authLink.style.display = "inline-block";
        if (logoutBtn) logoutBtn.style.display = "none";
        if (favoritesLink) favoritesLink.style.display = "none";
        if (adminLink) adminLink.style.display = "none";
        return;
      }

      if (authLink) authLink.style.display = "none";
      if (logoutBtn) logoutBtn.style.display = "inline-block";

      if (favoritesLink) {
        if (user.user.role === "user" || user.user.role === "admin") {
          favoritesLink.style.display = "inline-block";
        } else {
          favoritesLink.style.display = "none";
        }
      }
      if (user.user.role === "admin") {
        if (adminLink) adminLink.style.display = "inline-block";
      }
    }

    if (logoutBtn) {
      logoutBtn.addEventListener("click", () => {
        localStorage.removeItem("user");
        refreshHeader();
        window.location.href = "/";
      });
    }

    refreshHeader();
  }
</script>
